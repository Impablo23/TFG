"use strict";(self.webpackChunkTorrecomelinos2=self.webpackChunkTorrecomelinos2||[]).push([[97],{1097:(re,v,c)=>{c.r(v),c.d(v,{EstablecimientosModule:()=>ae});var g=c(6814),p=c(1896),d=c(5861),e=c(5879),m=c(2939),u=c(2539),h=c(2296),_=c(617),f=c(1919),T=c(2651),x=c(1274);function k(o,l){if(1&o){const t=e.EpF();e.TgZ(0,"mat-list-item",14),e.NdJ("click",function(){e.CHM(t),e.oxw(2);const i=e.MAs(2);return e.KtG(i.toggle())}),e.TgZ(1,"mat-icon",15),e._uU(2),e.qZA(),e._uU(3),e.qZA()}if(2&o){const t=l.$implicit;e.s9C("routerLink",t.url),e.xp6(2),e.Oqu(t.icon),e.xp6(1),e.hij(" ",t.label," ")}}function y(o,l){if(1&o&&(e.ynx(0),e.YNc(1,k,4,3,"mat-list-item",8),e.BQk()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.AdminItems)}}function E(o,l){if(1&o){const t=e.EpF();e.TgZ(0,"mat-list-item",14),e.NdJ("click",function(){e.CHM(t),e.oxw();const i=e.MAs(2);return e.KtG(i.toggle())}),e.TgZ(1,"mat-icon",15),e._uU(2),e.qZA(),e._uU(3),e.qZA()}if(2&o){const t=l.$implicit;e.s9C("routerLink",t.url),e.xp6(2),e.Oqu(t.icon),e.xp6(1),e.hij(" ",t.label," ")}}function F(o,l){if(1&o){const t=e.EpF();e.TgZ(0,"mat-list-item",14),e.NdJ("click",function(){e.CHM(t),e.oxw();const i=e.MAs(2);return e.KtG(i.toggle())}),e.TgZ(1,"mat-icon",15),e._uU(2),e.qZA(),e._uU(3),e.qZA()}if(2&o){const t=l.$implicit;e.s9C("routerLink",t.url),e.xp6(2),e.Oqu(t.icon),e.xp6(1),e.hij(" ",t.label," ")}}let q=(()=>{class o{constructor(t,n,i){this.router=t,this.snackbar=n,this.authApi=i,this.idRol="",this.nombre="",this.id="",this.token="",this.sidebarItems=[{label:"Listado",icon:"label",url:"./list"},{label:"B\xfasqueda",icon:"search",url:"./search"}],this.AdminItems=[{label:"Zona Administrador",icon:"settings_accessibility",url:"/admin"}],this.FavoriteItems=[{label:"Mis Lugares Favoritos",icon:"star",url:"./favourite-list"}]}ngOnInit(){var t=this;return(0,d.Z)(function*(){t.token=sessionStorage.getItem("tokenApi"),t.id=sessionStorage.getItem("id"),t.nombre=sessionStorage.getItem("nombreCompleto"),t.idRol=sessionStorage.getItem("idRol")})()}navega(t){this.router.navigate([`${t}`])}logout(){const t={id:0,id_usuario:parseInt(this.id),estado:"Desconectado",hora:this.authApi.obtenerFechaYHora((new Date).toISOString())};this.authApi.addRegistroApi(t,this.token).subscribe(n=>{sessionStorage.clear(),this.snackbar.open("Se ha Cerrado Sesi\xf3n correctamente","Cerrar",{duration:2e3,panelClass:["background"]}),this.router.navigate(["/auth"])},n=>{console.error("Error al agregar el registro:",n),this.snackbar.open("Se ha producido un error al cerrar sesi\xf3n","Cerrar",{duration:2e3,panelClass:["background"]})})}static#e=this.\u0275fac=function(n){return new(n||o)(e.Y36(p.F0),e.Y36(m.ux),e.Y36(u.Q))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-layout-page"]],decls:29,vars:4,consts:[["fullscreen","",2,"width","100%","height","100%","font-family","monospace","background-color","rgb(124 124 252)"],["mode","push",2,"width","350px","background-color","rgb(255, 255, 255)","color","rgb(255, 255, 255)"],["sidenav",""],[2,"background-color","rgb(124 124 252)","color","black"],[2,"font-family","monospace"],[1,"spacer"],["mat-icon-button","",3,"click"],[4,"ngIf"],[3,"routerLink","click",4,"ngFor","ngForOf"],["type","button",1,"btn","btn-outline-danger",2,"width","100%","font-family","monospace","margin-top","30px",3,"click"],["color","primary",2,"background-color","#ffffff","color","rgb(0, 0, 0)"],[2,"margin-top","14px","margin-right","30px","font-size","25px","font-family","monospace","margin-left","30px"],["type","button",1,"btn","btn-outline-danger",2,"margin","auto","font-family","monospace",3,"click"],[2,"background-color","rgb(124 124 252)","height","100%"],[3,"routerLink","click"],["matListItemIcon",""]],template:function(n,i){if(1&n){const a=e.EpF();e.TgZ(0,"mat-sidenav-container",0)(1,"mat-sidenav",1,2)(3,"mat-toolbar",3)(4,"span",4),e._uU(5),e.qZA(),e._UZ(6,"span",5),e.TgZ(7,"button",6),e.NdJ("click",function(){e.CHM(a);const C=e.MAs(2);return e.KtG(C.toggle())}),e.TgZ(8,"mat-icon"),e._uU(9,"menu"),e.qZA()()(),e.TgZ(10,"mat-nav-list"),e.YNc(11,y,2,1,"ng-container",7),e.YNc(12,E,4,3,"mat-list-item",8),e.ynx(13),e.YNc(14,F,4,3,"mat-list-item",8),e.BQk(),e.TgZ(15,"button",9),e.NdJ("click",function(){return i.logout()}),e._uU(16,"Cerrar Sesi\xf3n"),e.qZA()()(),e.TgZ(17,"mat-toolbar",10)(18,"button",6),e.NdJ("click",function(){e.CHM(a);const C=e.MAs(2);return e.KtG(C.toggle())}),e.TgZ(19,"mat-icon"),e._uU(20,"menu"),e.qZA()(),e.TgZ(21,"p",11),e._uU(22,"Torrecomelinos"),e.qZA(),e._UZ(23,"span",5),e.TgZ(24,"button",12),e.NdJ("click",function(){return i.logout()}),e.TgZ(25,"mat-icon"),e._uU(26,"logout"),e.qZA()()(),e.TgZ(27,"div",13),e._UZ(28,"router-outlet"),e.qZA()()}2&n&&(e.xp6(5),e.hij("Bienvenido, ",i.nombre," "),e.xp6(6),e.Q6J("ngIf","1"===i.idRol),e.xp6(1),e.Q6J("ngForOf",i.sidebarItems),e.xp6(2),e.Q6J("ngForOf",i.FavoriteItems))},dependencies:[g.sg,g.O5,p.lC,p.rH,h.RK,_.Hw,f.Hk,f.Tg,f.Yt,T.JX,T.TM,x.Ye]})}return o})();var b=c(2185),s=c(6223);function M(o,l){if(1&o){const t=e.EpF();e.TgZ(0,"button",14),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.navigateToAdd())}),e._uU(1,"A\xf1adir Establecimiento"),e.qZA()}}function U(o,l){if(1&o&&(e.TgZ(0,"option",8),e._uU(1),e.qZA()),2&o){const t=l.$implicit;e.Q6J("value",t.id),e.xp6(1),e.Oqu(t.nombre)}}function w(o,l){if(1&o&&(e.TgZ(0,"option",8),e._uU(1),e.qZA()),2&o){const t=l.$implicit;e.Q6J("value",t.id),e.xp6(1),e.Oqu(t.nombre)}}function P(o,l){if(1&o){const t=e.EpF();e.TgZ(0,"a",21),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit,a=e.oxw();return e.KtG(a.navigateToDelete(i.id))}),e.TgZ(1,"mat-icon"),e._uU(2,"delete"),e.qZA()()}}function N(o,l){if(1&o){const t=e.EpF();e.TgZ(0,"div",15)(1,"div",16)(2,"p",17),e._uU(3),e.qZA(),e.TgZ(4,"a",18),e._uU(5,"Sitio web"),e.qZA(),e.TgZ(6,"a",19),e.NdJ("click",function(){const a=e.CHM(t).$implicit,r=e.oxw();return e.KtG(r.navigateToDetails(a.id))}),e._uU(7,"Detalles"),e.qZA(),e.YNc(8,P,3,0,"a",20),e.qZA()()}if(2&o){const t=l.$implicit,n=e.oxw();e.Jzz("margin-left: 20px;margin-bottom: 20px;background: url(",n.evitarErrorEnFoto(t.foto),");background-repeat: no-repeat;background-size: 100%;"),e.xp6(3),e.AsE("",t.nombre," (",n.obtenerNombreZona(t.id_zona),")"),e.xp6(1),e.s9C("href",t.enlace,e.LSH),e.xp6(4),e.Q6J("ngIf","1"===n.idRol)}}let J=(()=>{class o{constructor(t,n,i,a){this.router=t,this.establecimientoApi=n,this.snackbar=i,this.authApi=a,this.listadoEstablecimientos=[],this.listadoZonas=[],this.listadoCategorias=[],this.establecimientosFiltrados=[],this.zonaSeleccionada=0,this.categoriaSeleccionada=0,this.tokenApi="",this.idRol=""}ngOnInit(){var t=this;return(0,d.Z)(function*(){t.tokenApi=sessionStorage.getItem("tokenApi"),t.idRol=sessionStorage.getItem("idRol"),yield t.obtenerDatos()})()}obtenerDatos(){var t=this;return(0,d.Z)(function*(){try{const n=yield t.establecimientoApi.getEstablecimientosApi(t.tokenApi).toPromise();t.listadoEstablecimientos=n,t.establecimientosFiltrados=t.listadoEstablecimientos;const i=yield t.establecimientoApi.getZonasApi(t.tokenApi).toPromise();t.listadoZonas=i;const a=yield t.establecimientoApi.getCategoriasApi(t.tokenApi).toPromise();t.listadoCategorias=a}catch(n){console.error("Error en la inicializaci\xf3n:",n)}})()}filtrarEstablecimientos(){let t=parseInt(this.zonaSeleccionada.toString(),10),n=parseInt(this.categoriaSeleccionada.toString(),10);0===t&&0===n?this.establecimientosFiltrados=this.listadoEstablecimientos:0===t?(this.establecimientosFiltrados=this.listadoEstablecimientos.filter(i=>i.id_categoria===n),this.snackbar.open("Establecientos de "+this.obtenerNombreCategoria(n),"Cerrar",{duration:2e3,panelClass:["background"]})):0===n?(this.establecimientosFiltrados=this.listadoEstablecimientos.filter(i=>i.id_zona===t),this.snackbar.open("Establecientos en "+this.obtenerNombreZona(t),"Cerrar",{duration:2e3,panelClass:["background"]})):(this.establecimientosFiltrados=this.listadoEstablecimientos.filter(i=>i.id_zona===t&&i.id_categoria===n),this.snackbar.open("Establecientos en "+this.obtenerNombreZona(t)+" de "+this.obtenerNombreCategoria(n),"Cerrar",{duration:2e3,panelClass:["background"]})),0===this.establecimientosFiltrados.length&&(this.snackbar.open("No se encontraron establecimientos que cumplan con los criterios de b\xfasqueda.","Cerrar",{duration:2e3,panelClass:["background"]}),this.establecimientosFiltrados=this.listadoEstablecimientos)}restablecerListado(){this.zonaSeleccionada=0,this.categoriaSeleccionada=0,this.establecimientosFiltrados=this.listadoEstablecimientos}obtenerNombreZona(t){let n="";for(const i of this.listadoZonas)i.id===t&&(n=i.nombre),0===t&&(n="Sin Especificar");return n}obtenerNombreCategoria(t){let n="";for(const i of this.listadoCategorias)i.id==t&&(n=i.nombre),0===t&&(n="Sin Especificar");return n}navigateToDetails(t){this.router.navigate([`establecimientos/details/${t}`])}navigateToDelete(t){this.router.navigate([`establecimientos/delete/${t}`])}navigateToAdd(){this.router.navigate(["establecimientos/add"])}navigateToSuggestion(){this.router.navigate(["establecimientos/suggestions"])}evitarErrorEnFoto(t){return 0===t.length?"assets/no_foto.png":t}static#e=this.\u0275fac=function(n){return new(n||o)(e.Y36(p.F0),e.Y36(b.X),e.Y36(m.ux),e.Y36(u.Q))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-list-page"]],decls:22,vars:8,consts:[[2,"padding","40px"],[2,"text-align","center","font-size","40px","font-family","monospace"],[2,"float","left","margin-bottom","20px"],["style","margin-right: 20px;","type","button","class","btn btn-outline-success",3,"click",4,"ngIf"],["type","button",1,"btn","btn-outline-success",3,"click"],[2,"width","300px"],[1,"input-group","flex-nowrap",2,"width","100%","margin","auto","margin-top","10px"],["id","zona","name","zona",1,"form-control",3,"ngModel","ngModelChange","change"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],["id","categoria","name","categoria",1,"form-control",3,"ngModel","ngModelChange","change"],["type","button",1,"btn","btn-outline-info",2,"margin-top","10px",3,"click"],[1,"grid","mb-8",2,"background-color","rgb(124 124 252)","margin","auto","height","100%","margin-left","20px","margin-top","50px"],["class","card",3,"style",4,"ngFor","ngForOf"],["type","button",1,"btn","btn-outline-success",2,"margin-right","20px",3,"click"],[1,"card"],[1,"card__content"],[1,"card__title"],["target","_blank","type","button",1,"btn","btn-outline-primary",2,"margin-top","10px","margin-left","30px","margin-top","30px",3,"href"],["type","button",1,"btn","btn-outline-secondary",2,"margin-top","10px","margin-left","10px","margin-top","30px",3,"click"],["type","button","class","btn btn-outline-danger","style","margin-top: 10px;margin-left: 105px;",3,"click",4,"ngIf"],["type","button",1,"btn","btn-outline-danger",2,"margin-top","10px","margin-left","105px",3,"click"]],template:function(n,i){1&n&&(e.TgZ(0,"div",0)(1,"h1",1),e._uU(2,"Listado de Establecimientos"),e.qZA(),e.TgZ(3,"div",2),e.YNc(4,M,2,0,"button",3),e.TgZ(5,"button",4),e.NdJ("click",function(){return i.navigateToSuggestion()}),e._uU(6,"A\xf1adir Sugerencia"),e.qZA()(),e.TgZ(7,"div",5)(8,"form",6)(9,"select",7),e.NdJ("ngModelChange",function(r){return i.zonaSeleccionada=r})("change",function(){return i.filtrarEstablecimientos()}),e.TgZ(10,"option",8),e._uU(11,"Selecciona una zona"),e.qZA(),e.YNc(12,U,2,2,"option",9),e.qZA()(),e.TgZ(13,"form",6)(14,"select",10),e.NdJ("ngModelChange",function(r){return i.categoriaSeleccionada=r})("change",function(){return i.filtrarEstablecimientos()}),e.TgZ(15,"option",8),e._uU(16,"Selecciona una categor\xeda"),e.qZA(),e.YNc(17,w,2,2,"option",9),e.qZA()()(),e.TgZ(18,"button",11),e.NdJ("click",function(){return i.restablecerListado()}),e._uU(19,"Restablecer Filtros"),e.qZA()(),e.TgZ(20,"div",12),e.YNc(21,N,9,7,"div",13),e.qZA()),2&n&&(e.xp6(4),e.Q6J("ngIf","1"===i.idRol),e.xp6(5),e.Q6J("ngModel",i.zonaSeleccionada),e.xp6(1),e.Q6J("value",0),e.xp6(2),e.Q6J("ngForOf",i.listadoZonas),e.xp6(2),e.Q6J("ngModel",i.categoriaSeleccionada),e.xp6(1),e.Q6J("value",0),e.xp6(2),e.Q6J("ngForOf",i.listadoCategorias),e.xp6(4),e.Q6J("ngForOf",i.establecimientosFiltrados))},dependencies:[g.sg,g.O5,_.Hw,s._Y,s.YN,s.Kr,s.EJ,s.JJ,s.JL,s.On,s.F],styles:[".card[_ngcontent-%COMP%]{position:relative;width:300px;height:200px;border-radius:10px;display:flex;align-items:center;justify-content:center;overflow:hidden;transition:all .6s cubic-bezier(.23,1,.32,1)}.card[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:48px;fill:#333;transition:all .6s cubic-bezier(.23,1,.32,1)}.card[_ngcontent-%COMP%]:hover{transform:rotate(-5deg) scale(1.1);box-shadow:0 10px 20px #0003}.card__content[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%) rotate(-45deg);width:100%;height:100%;padding:20px;box-sizing:border-box;background-color:#fff;opacity:0;color:#000;transition:all .6s cubic-bezier(.23,1,.32,1)}.card[_ngcontent-%COMP%]:hover   .card__content[_ngcontent-%COMP%]{transform:translate(-50%,-50%) rotate(0);opacity:1}.card__title[_ngcontent-%COMP%]{margin:0;font-size:17px;color:#000;font-weight:700;text-align:center}.card__description[_ngcontent-%COMP%]{margin:10px 0 0;font-size:14px;color:#fff;line-height:1.4}.card[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{scale:0;transform:rotate(-45deg)}"]})}return o})();var S=c(3620),D=c(3997);function z(o,l){if(1&o){const t=e.EpF();e.TgZ(0,"div",6)(1,"div",7)(2,"p",8),e._uU(3),e.qZA(),e.TgZ(4,"a",9),e._uU(5,"Sitio web"),e.qZA(),e.TgZ(6,"a",10),e.NdJ("click",function(){const a=e.CHM(t).$implicit,r=e.oxw();return e.KtG(r.navigateToDetails(a.id))}),e._uU(7,"Detalles"),e.qZA(),e.TgZ(8,"a",11)(9,"mat-icon"),e._uU(10,"delete"),e.qZA()()()()}if(2&o){const t=l.$implicit,n=e.oxw();e.Jzz("margin-left: 20px;margin-bottom: 20px;background: url(",n.evitarErrorEnFoto(t.foto),");background-repeat: no-repeat;background-size: 100%;"),e.xp6(3),e.AsE("",t.nombre," (",n.obtenerNombreZona(t.id_zona),")"),e.xp6(1),e.s9C("href",t.enlace,e.LSH)}}let O=(()=>{class o{constructor(t,n,i,a){this.snackbar=t,this.router=n,this.establecimientoApi=i,this.authApi=a,this.establecimientosEncontrados=[],this.establecimientos=[],this.listadoZonas=[],this.valorBusqueda="",this.tokenApi="",this.searchForm=new s.cw({searchInput:new s.NI("")})}ngOnInit(){var t=this;return(0,d.Z)(function*(){t.tokenApi=sessionStorage.getItem("tokenApi"),t.searchForm.get("searchInput").valueChanges.pipe((0,S.b)(300),(0,D.x)()).subscribe(i=>{i.trim()?t.cargarEstablecimientos(i):t.establecimientosEncontrados=[]});const n=yield t.establecimientoApi.getZonasApi(t.tokenApi).toPromise();t.listadoZonas=n,t.obtenerEstablecimientos()})()}obtenerEstablecimientos(){var t=this;return(0,d.Z)(function*(){const n=yield t.establecimientoApi.getEstablecimientosApi(t.tokenApi).toPromise();t.establecimientos=n})()}cargarEstablecimientos(t){this.establecimientosEncontrados=this.establecimientos.filter(n=>n.nombre.includes(t)),this.snackbar.open(0===this.establecimientosEncontrados.length?"No se han encontrado resultados de "+t:"Resultados de "+t,"Cerrar",{duration:2e3,panelClass:["background"]})}obtenerNombreZona(t){let n="";for(const i of this.listadoZonas)i.id===t&&(n=i.nombre),0===t&&(n="Sin Especificar");return n}evitarErrorEnFoto(t){return 0===t.length?"assets/no_foto.png":t}navigateToDetails(t){this.router.navigate([`establecimientos/details/${t}`])}reseteo(){this.searchForm.get("searchInput").setValue("")}static#e=this.\u0275fac=function(n){return new(n||o)(e.Y36(m.ux),e.Y36(p.F0),e.Y36(b.X),e.Y36(u.Q))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-search-page"]],decls:7,vars:2,consts:[[2,"padding","30px","text-align","center"],[2,"font-size","40px","font-family","monospace"],[1,"input-group","flex-nowrap",2,"width","80%","margin","auto","padding","20px",3,"formGroup"],["type","text","placeholder","Nombre de alg\xfan establecimiento","aria-label","Username","aria-describedby","addon-wrapping","formControlName","searchInput",1,"form-control",3,"keyup.enter"],[1,"grid","mb-8",2,"background-color","rgb(124 124 252)","margin","auto","height","100%","margin-left","20px","margin-top","50px"],["class","card",3,"style",4,"ngFor","ngForOf"],[1,"card"],[1,"card__content"],[1,"card__title"],["target","_blank","type","button",1,"btn","btn-outline-primary",2,"margin-top","10px","margin-left","30px","margin-top","30px",3,"href"],["type","button",1,"btn","btn-outline-secondary",2,"margin-top","10px","margin-left","10px","margin-top","30px",3,"click"],["type","button",1,"btn","btn-outline-danger",2,"margin-top","10px","margin-left","105px"]],template:function(n,i){1&n&&(e.TgZ(0,"div",0)(1,"h1",1),e._uU(2,"Busca un Establecimiento"),e.qZA()(),e.TgZ(3,"form",2)(4,"input",3),e.NdJ("keyup.enter",function(){return i.reseteo()}),e.qZA()(),e.TgZ(5,"div",4),e.YNc(6,z,11,6,"div",5),e.qZA()),2&n&&(e.xp6(3),e.Q6J("formGroup",i.searchForm),e.xp6(3),e.Q6J("ngForOf",i.establecimientosEncontrados))},dependencies:[g.sg,_.Hw,s._Y,s.Fj,s.JJ,s.JL,s.sg,s.u],styles:[".card[_ngcontent-%COMP%]{position:relative;width:300px;height:200px;border-radius:10px;display:flex;align-items:center;justify-content:center;overflow:hidden;transition:all .6s cubic-bezier(.23,1,.32,1)}.card[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:48px;fill:#333;transition:all .6s cubic-bezier(.23,1,.32,1)}.card[_ngcontent-%COMP%]:hover{transform:rotate(-5deg) scale(1.1);box-shadow:0 10px 20px #0003}.card__content[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%) rotate(-45deg);width:100%;height:100%;padding:20px;box-sizing:border-box;background-color:#fff;opacity:0;color:#000;transition:all .6s cubic-bezier(.23,1,.32,1)}.card[_ngcontent-%COMP%]:hover   .card__content[_ngcontent-%COMP%]{transform:translate(-50%,-50%) rotate(0);opacity:1}.card__title[_ngcontent-%COMP%]{margin:0;font-size:17px;color:#000;font-weight:700;text-align:center}.card__description[_ngcontent-%COMP%]{margin:10px 0 0;font-size:14px;color:#fff;line-height:1.4}.card[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{scale:0;transform:rotate(-45deg)}"]})}return o})();var Z=c(4664);function I(o,l){if(1&o){const t=e.EpF();e.TgZ(0,"a",20),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.goToEdit(i.establecimientoDetalles.id))}),e.TgZ(1,"mat-icon"),e._uU(2,"edit"),e.qZA()()}}function Y(o,l){if(1&o){const t=e.EpF();e.TgZ(0,"label",21)(1,"input",22),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.addFavoritoApi(i.establecimientoDetalles.id))}),e.qZA(),e.O4$(),e.TgZ(2,"svg",23),e._UZ(3,"path",24),e.qZA()()}}function L(o,l){if(1&o){const t=e.EpF();e.TgZ(0,"label",25)(1,"input",22),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.eliminaFavoritoApi(i.establecimientoDetalles.id))}),e.qZA(),e.O4$(),e.TgZ(2,"svg",23),e._UZ(3,"path",24),e.qZA()()}}let Q=(()=>{class o{constructor(t,n,i,a,r){this.activatedRoute=t,this.router=n,this.snackbar=i,this.establecimientoApi=a,this.authApi=r,this.listadoZonas=[],this.listadoCategorias=[],this.idRol="",this.id="",this.esFavorito=!1,this.numFav=0,this.tokenApi=""}goToList(){this.router.navigate(["/establecimientos/list"])}goToEdit(t){this.router.navigate([`/establecimientos/edit/${t}`])}ngOnInit(){var t=this;return(0,d.Z)(function*(){t.tokenApi=sessionStorage.getItem("tokenApi"),t.id=sessionStorage.getItem("id"),t.idRol=sessionStorage.getItem("idRol");const n=yield t.establecimientoApi.getZonasApi(t.tokenApi).toPromise();t.listadoZonas=n;const i=yield t.establecimientoApi.getCategoriasApi(t.tokenApi).toPromise();t.listadoCategorias=i,t.activatedRoute.params.pipe((0,Z.w)(({id:a})=>t.establecimientoApi.getEstablecimientoApiById(a,t.tokenApi))).subscribe(a=>{if(!a)return t.router.navigate(["/establecimientos/list"]);t.establecimientoDetalles=a[0],t.verificarFavoritoApi(parseInt(t.id),t.establecimientoDetalles.id)})})()}obtenerNombreZona(t){let n="";for(const i of this.listadoZonas)i.id===t&&(n=i.nombre),0===t&&(n="Sin Especificar");return n}obtenerNombreCategoria(t){let n="";for(const i of this.listadoCategorias)i.id==t&&(n=i.nombre),0===t&&(n="Sin Especificar");return n}evitarErrorEnFoto(t){return 0===t.length?"assets/no_foto.png":t}verificarFavoritoApi(t,n){this.establecimientoApi.getFavoritoByUserByNameApi(t,n,this.tokenApi).subscribe(i=>{null!=i[0]&&(this.esFavorito=!0)})}addFavoritoApi(t){const n={id:0,id_usuario:parseInt(this.id),id_establecimiento:t};this.establecimientoApi.addFavoritoApi(n,this.tokenApi).subscribe(i=>{this.snackbar.open("Establecimiento a\xf1adido de favoritos","Cerrar",{duration:2e3,panelClass:["background"]}).afterDismissed().subscribe(()=>{}),this.esFavorito=!0})}eliminaFavoritoApi(t){this.establecimientoApi.getFavoritoByUserByNameApi(parseInt(this.id),t,this.tokenApi).subscribe(n=>{const i=n[0];null!=i?this.establecimientoApi.deleteFavoritoApi(i.id,this.tokenApi).subscribe(a=>{this.snackbar.open("Establecimiento eliminado de favoritos","Cerrar",{duration:2e3,panelClass:["background"]}).afterDismissed().subscribe(()=>{}),this.esFavorito=!1},a=>{this.snackbar.open("Error al eliminar el establecimiento a favoritos","Cerrar",{duration:2e3,panelClass:["background"]}).afterDismissed().subscribe(()=>{})}):this.snackbar.open("Error al eliminar el establecimiento a favoritos","Cerrar",{duration:2e3,panelClass:["background"]}).afterDismissed().subscribe(()=>{})})}static#e=this.\u0275fac=function(n){return new(n||o)(e.Y36(p.gz),e.Y36(p.F0),e.Y36(m.ux),e.Y36(b.X),e.Y36(u.Q))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-details-page"]],decls:36,vars:13,consts:[[1,"container","py-4"],["id","pageHeaderTitle",1,"h1","text-center"],[1,"postcard","dark","blue",2,"width","70%","margin","auto"],["href","#",1,"postcard__img_link"],[1,"postcard__img",3,"src","alt"],[1,"postcard__text"],[1,"postcard__title","blue"],[2,"font-size","15px"],[1,"postcard__subtitle","small"],["datetime","2020-05-25 12:00:00"],[1,"fas","fa-calendar-alt","mr-2"],[1,"postcard__bar"],[2,"font-size","15px","font-weight","bold"],[2,"float","left"],["target","_blank","type","button",1,"btn","btn-outline-primary",2,"width","30%","margin-right","20px",3,"href"],["type","button","class","btn btn-outline-success","style","width: 25%;margin-left: 20px;",3,"click",4,"ngIf"],["class","container",4,"ngIf"],["class","containerok",4,"ngIf"],[2,"width","200px","height","45px","margin","auto","margin-top","30px","border-radius","10px"],["mat-raised-button","",2,"width","100%","font-family","monospace",3,"click"],["type","button",1,"btn","btn-outline-success",2,"width","25%","margin-left","20px",3,"click"],[1,"container"],["type","checkbox",3,"click"],["id","Layer_1","version","1.0","viewBox","0 0 24 24",0,"xml","space","preserve","xmlns","http://www.w3.org/2000/svg",0,"xmlns","xlink","http://www.w3.org/1999/xlink"],["d","M16.4,4C14.6,4,13,4.9,12,6.3C11,4.9,9.4,4,7.6,4C4.5,4,2,6.5,2,9.6C2,14,12,22,12,22s10-8,10-12.4C22,6.5,19.5,4,16.4,4z"],[1,"containerok"]],template:function(n,i){1&n&&(e.TgZ(0,"section")(1,"div",0),e._UZ(2,"h1",1),e.TgZ(3,"article",2)(4,"a",3),e._UZ(5,"img",4),e.qZA(),e.TgZ(6,"div",5)(7,"h1",6)(8,"a"),e._uU(9),e.TgZ(10,"span",7),e._uU(11),e.qZA()()(),e.TgZ(12,"div",8)(13,"time",9),e._UZ(14,"i",10),e._uU(15),e.qZA()(),e._UZ(16,"div",11),e.TgZ(17,"p"),e._uU(18),e.qZA(),e.TgZ(19,"p")(20,"span",12),e._uU(21,"Direcci\xf3n: "),e.qZA(),e._uU(22),e.qZA(),e.TgZ(23,"p")(24,"span",12),e._uU(25,"Tel\xe9fono: "),e.qZA(),e._uU(26),e.qZA(),e.TgZ(27,"div",13)(28,"a",14),e._uU(29,"Sitio web"),e.qZA(),e.YNc(30,I,3,0,"a",15),e.YNc(31,Y,4,0,"label",16),e.YNc(32,L,4,0,"label",17),e.qZA()()()()(),e.TgZ(33,"div",18)(34,"button",19),e.NdJ("click",function(){return i.goToList()}),e._uU(35,"Volver al listado"),e.qZA()()),2&n&&(e.xp6(5),e.s9C("src",i.evitarErrorEnFoto(i.establecimientoDetalles.foto),e.LSH),e.s9C("alt",i.establecimientoDetalles.nombre),e.xp6(4),e.AsE("",i.establecimientoDetalles.nombre," (",i.obtenerNombreZona(i.establecimientoDetalles.id_zona),") "),e.xp6(2),e.hij("Rese\xf1as: ",i.establecimientoDetalles.numResenas,""),e.xp6(4),e.hij("Categor\xeda: ",i.obtenerNombreCategoria(i.establecimientoDetalles.id_categoria)," "),e.xp6(3),e.Oqu(i.establecimientoDetalles.descripcion),e.xp6(4),e.Oqu(i.establecimientoDetalles.direccion),e.xp6(4),e.Oqu(i.establecimientoDetalles.telefono),e.xp6(2),e.s9C("href",i.establecimientoDetalles.enlace,e.LSH),e.xp6(2),e.Q6J("ngIf","1"===i.idRol),e.xp6(1),e.Q6J("ngIf",!i.esFavorito),e.xp6(1),e.Q6J("ngIf",i.esFavorito))},dependencies:[g.O5,h.lW,_.Hw]})}return o})();function R(o,l){if(1&o&&(e.TgZ(0,"option",42),e._uU(1),e.qZA()),2&o){const t=l.$implicit;e.Q6J("value",t.id),e.xp6(1),e.Oqu(t.nombre)}}function H(o,l){if(1&o&&(e.TgZ(0,"option",42),e._uU(1),e.qZA()),2&o){const t=l.$implicit;e.Q6J("value",t.id),e.xp6(1),e.Oqu(t.nombre)}}let $=(()=>{class o{constructor(t,n,i,a,r){this.activatedRoute=t,this.router=n,this.snackbar=i,this.establecimientoApi=a,this.authApi=r,this.listadoZonas=[],this.listadoCategorias=[],this.nombre="",this.descripcion="",this.direccion="",this.telefono="",this.foto="",this.enlace="",this.numResenas=0,this.id_zona=0,this.id_categoria=0,this.tokenApi=""}ngOnInit(){var t=this;return(0,d.Z)(function*(){t.tokenApi=sessionStorage.getItem("tokenApi"),yield t.obtenerEstablecimiento()})()}obtenerEstablecimiento(){var t=this;return(0,d.Z)(function*(){const n=yield t.establecimientoApi.getZonasApi(t.tokenApi).toPromise();t.listadoZonas=n;const i=yield t.establecimientoApi.getCategoriasApi(t.tokenApi).toPromise();t.listadoCategorias=i,t.activatedRoute.params.pipe((0,Z.w)(({id:a})=>t.establecimientoApi.getEstablecimientoApiById(a,t.tokenApi))).subscribe(a=>{if(!a)return t.router.navigate(["/establecimientos/list"]);t.establecimientoDetalles=a[0],t.nombre=t.establecimientoDetalles.nombre,t.descripcion=t.establecimientoDetalles.descripcion,t.direccion=t.establecimientoDetalles.direccion,t.telefono=t.establecimientoDetalles.telefono,t.foto=t.establecimientoDetalles.foto,t.enlace=t.establecimientoDetalles.enlace,t.numResenas=t.establecimientoDetalles.numResenas,t.id_zona=t.establecimientoDetalles.id_zona,t.id_categoria=t.establecimientoDetalles.id_categoria})})()}goToDetails(t){this.router.navigate([`/establecimientos/details/${t}`])}obtenerNombreZona(t){let n="";for(const i of this.listadoZonas)i.id==t&&(n=i.nombre),0===t&&(n="Sin Especificar");return n}obtenerNombreCategoria(t){let n="";for(const i of this.listadoCategorias)i.id==t&&(n=i.nombre),0===t&&(n="Sin Especificar");return n}evitarErrorEnFoto(t){return 0===t.length?"assets/no_foto.png":t}editarEstablecimientoApi(){const t={id:this.establecimientoDetalles.id,nombre:this.nombre,descripcion:this.descripcion,numResenas:this.numResenas,direccion:this.direccion,telefono:this.telefono,foto:this.foto,enlace:this.enlace,id_zona:this.id_zona,id_categoria:this.id_categoria};0!==this.nombre.length&&0!==this.id_zona&&0!==this.id_categoria?this.establecimientoApi.updateEstablecimientoApi(t,this.tokenApi).subscribe(n=>{this.snackbar.open("Establecimiento actualizado correctamente","Cerrar",{duration:2e3,panelClass:["background"]}),this.router.navigate([`/establecimientos/details/${t.id}`])},n=>{this.snackbar.open("Ha ocurrido un error al actualizar el establecimiento","Cerrar",{duration:2e3,panelClass:["background"]})}):this.snackbar.open("No has rellenado todos los datos obligatorios","Cerrar",{duration:2e3,panelClass:["background"]})}static#e=this.\u0275fac=function(n){return new(n||o)(e.Y36(p.gz),e.Y36(p.F0),e.Y36(m.ux),e.Y36(b.X),e.Y36(u.Q))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-edit-page"]],decls:92,vars:22,consts:[[2,"height","80%","width","100%"],[2,"font-family","monospace","text-align","center","padding","20px"],[1,"container","py-4"],["id","pageHeaderTitle",1,"h1","text-center"],[1,"postcard","dark","blue",2,"width","70%","margin","auto"],["href","#",1,"postcard__img_link"],[1,"postcard__img",3,"src","alt"],[1,"postcard__text"],[1,"postcard__title","blue"],[2,"font-size","15px"],[1,"postcard__subtitle","small"],["datetime","2020-05-25 12:00:00"],[1,"fas","fa-calendar-alt","mr-2"],[1,"postcard__bar"],[2,"font-size","15px","font-weight","bold"],[2,"float","left"],["target","_blank","type","button",1,"btn","btn-outline-primary",2,"width","30%","margin-right","20px",3,"href"],[2,"height","20%","width","100%","margin-bottom","30px"],[2,"width","70%","margin","auto"],[1,"input-group","flex-nowrap",2,"width","100%","margin","auto","padding","10px"],["for","nombre",2,"text-align","left","margin-top","10px","margin-right","10px"],["type","text","placeholder","Nombre","aria-label","Nombre","aria-describedby","addon-wrapping","name","nombre","required","",1,"form-control",3,"ngModel","ngModelChange"],["for","zona",2,"text-align","left","margin-top","10px","margin-right","10px"],["id","zona","name","zona",1,"form-control",3,"ngModel","ngModelChange"],["value","0","disabled","","selected","","hidden",""],[3,"value",4,"ngFor","ngForOf"],["for","numResenas",2,"text-align","left","margin-top","10px","margin-right","10px"],["type","number","placeholder","N\xfamero de Rese\xf1as","aria-label","N\xfamero de Rese\xf1as","aria-describedby","addon-wrapping","name","numResenas",1,"form-control",3,"ngModel","ngModelChange"],["id","caterogia","name","zona",1,"form-control",3,"ngModel","ngModelChange"],["for","descripcion",2,"text-align","left","margin-top","10px","margin-right","10px"],["type","text","placeholder","Descripci\xf3n","aria-label","Descripci\xf3n","aria-describedby","addon-wrapping","name","descripcion",1,"form-control",3,"ngModel","ngModelChange"],["for","direccion",2,"text-align","left","margin-top","10px","margin-right","10px"],["type","text","placeholder","Direcci\xf3n","aria-label","Direcci\xf3n","aria-describedby","addon-wrapping","name","direccion",1,"form-control",3,"ngModel","ngModelChange"],["for","telefono",2,"text-align","left","margin-top","10px","margin-right","10px"],["type","text","placeholder","Tel\xe9fono","aria-label","Tel\xe9fono","aria-describedby","addon-wrapping","name","telefono",1,"form-control",3,"ngModel","ngModelChange"],["for","foto",2,"text-align","left","margin-top","10px","margin-right","10px"],["type","text","placeholder","Enlace para la foto","aria-label","Enlace para la foto","aria-describedby","addon-wrapping","name","foto",1,"form-control",3,"ngModel","ngModelChange"],["for","enlace",2,"text-align","left","margin-top","10px","margin-right","10px"],["type","text","placeholder","Enlace al sitio web","aria-label","Enlace al sitio web","aria-describedby","addon-wrapping","name","enlace",1,"form-control",3,"ngModel","ngModelChange"],[2,"font-family","monospace","width","50%","margin","auto","margin-top","20px","margin-bottom","10px"],["type","button",1,"btn","btn-outline-success",2,"margin-right","20px","float","left",3,"click"],["type","button",1,"btn","btn-outline-danger",2,"float","right",3,"click"],[3,"value"]],template:function(n,i){1&n&&(e.TgZ(0,"div",0)(1,"h1",1),e._uU(2,"Vista Previa"),e.qZA(),e.TgZ(3,"section")(4,"div",2),e._UZ(5,"h1",3),e.TgZ(6,"article",4)(7,"a",5),e._UZ(8,"img",6),e.qZA(),e.TgZ(9,"div",7)(10,"h1",8)(11,"a"),e._uU(12),e.TgZ(13,"span",9),e._uU(14),e.qZA()()(),e.TgZ(15,"div",10)(16,"time",11),e._UZ(17,"i",12),e._uU(18),e.qZA()(),e._UZ(19,"div",13),e.TgZ(20,"p"),e._uU(21),e.qZA(),e.TgZ(22,"p")(23,"span",14),e._uU(24,"Direcci\xf3n: "),e.qZA(),e._uU(25),e.qZA(),e.TgZ(26,"p")(27,"span",14),e._uU(28,"Tel\xe9fono: "),e.qZA(),e._uU(29),e.qZA(),e.TgZ(30,"div",15)(31,"a",16),e._uU(32,"Sitio web"),e.qZA()()()()()()(),e.TgZ(33,"div",17)(34,"h1",1),e._uU(35),e.qZA(),e.TgZ(36,"div",18)(37,"form",19)(38,"label",20),e._uU(39,"Nombre:"),e.qZA(),e.TgZ(40,"input",21),e.NdJ("ngModelChange",function(r){return i.nombre=r}),e.qZA()()(),e.TgZ(41,"div",18)(42,"form",19)(43,"label",22),e._uU(44,"Zona:"),e.qZA(),e.TgZ(45,"select",23),e.NdJ("ngModelChange",function(r){return i.id_zona=r}),e.TgZ(46,"option",24),e._uU(47,"Selecciona una zona*"),e.qZA(),e.YNc(48,R,2,2,"option",25),e.qZA()()(),e.TgZ(49,"div",18)(50,"form",19)(51,"label",26),e._uU(52,"N\xfamero de Rese\xf1as:"),e.qZA(),e.TgZ(53,"input",27),e.NdJ("ngModelChange",function(r){return i.numResenas=r}),e.qZA()()(),e.TgZ(54,"div",18)(55,"form",19)(56,"label",22),e._uU(57,"Categor\xeda:"),e.qZA(),e.TgZ(58,"select",28),e.NdJ("ngModelChange",function(r){return i.id_categoria=r}),e.TgZ(59,"option",24),e._uU(60,"Selecciona una zona*"),e.qZA(),e.YNc(61,H,2,2,"option",25),e.qZA()()(),e.TgZ(62,"div",18)(63,"form",19)(64,"label",29),e._uU(65,"Descripci\xf3n:"),e.qZA(),e.TgZ(66,"input",30),e.NdJ("ngModelChange",function(r){return i.descripcion=r}),e.qZA()()(),e.TgZ(67,"div",18)(68,"form",19)(69,"label",31),e._uU(70,"Direcci\xf3n:"),e.qZA(),e.TgZ(71,"input",32),e.NdJ("ngModelChange",function(r){return i.direccion=r}),e.qZA()()(),e.TgZ(72,"div",18)(73,"form",19)(74,"label",33),e._uU(75,"Tel\xe9fono:"),e.qZA(),e.TgZ(76,"input",34),e.NdJ("ngModelChange",function(r){return i.telefono=r}),e.qZA()()(),e.TgZ(77,"div",18)(78,"form",19)(79,"label",35),e._uU(80,"Enlace foto:"),e.qZA(),e.TgZ(81,"input",36),e.NdJ("ngModelChange",function(r){return i.foto=r}),e.qZA()()(),e.TgZ(82,"div",18)(83,"form",19)(84,"label",37),e._uU(85,"Enlace web:"),e.qZA(),e.TgZ(86,"input",38),e.NdJ("ngModelChange",function(r){return i.enlace=r}),e.qZA()()(),e.TgZ(87,"div",39)(88,"button",40),e.NdJ("click",function(){return i.editarEstablecimientoApi()}),e._uU(89,"Aceptar"),e.qZA(),e.TgZ(90,"button",41),e.NdJ("click",function(){return i.goToDetails(i.establecimientoDetalles.id)}),e._uU(91,"Cancelar"),e.qZA()()()),2&n&&(e.xp6(8),e.s9C("src",i.evitarErrorEnFoto(i.foto),e.LSH),e.s9C("alt",i.foto),e.xp6(4),e.AsE("",i.nombre," (",i.obtenerNombreZona(i.id_zona),") "),e.xp6(2),e.hij("Rese\xf1as: ",i.numResenas,""),e.xp6(4),e.hij("Categor\xeda: ",i.obtenerNombreCategoria(i.id_categoria)," "),e.xp6(3),e.Oqu(i.descripcion),e.xp6(4),e.Oqu(i.direccion),e.xp6(4),e.Oqu(i.telefono),e.xp6(2),e.s9C("href",i.enlace,e.LSH),e.xp6(4),e.hij("Editar establecimiento: ",null==i.establecimientoDetalles?null:i.establecimientoDetalles.nombre,""),e.xp6(5),e.Q6J("ngModel",i.nombre),e.xp6(5),e.Q6J("ngModel",i.id_zona),e.xp6(3),e.Q6J("ngForOf",i.listadoZonas),e.xp6(5),e.Q6J("ngModel",i.numResenas),e.xp6(5),e.Q6J("ngModel",i.id_categoria),e.xp6(3),e.Q6J("ngForOf",i.listadoCategorias),e.xp6(5),e.Q6J("ngModel",i.descripcion),e.xp6(5),e.Q6J("ngModel",i.direccion),e.xp6(5),e.Q6J("ngModel",i.telefono),e.xp6(5),e.Q6J("ngModel",i.foto),e.xp6(5),e.Q6J("ngModel",i.enlace))},dependencies:[g.sg,s._Y,s.YN,s.Kr,s.Fj,s.wV,s.EJ,s.JJ,s.JL,s.Q7,s.On,s.F]})}return o})();function B(o,l){if(1&o&&(e.TgZ(0,"option",42),e._uU(1),e.qZA()),2&o){const t=l.$implicit;e.Q6J("value",t.id),e.xp6(1),e.Oqu(t.nombre)}}function j(o,l){if(1&o&&(e.TgZ(0,"option",42),e._uU(1),e.qZA()),2&o){const t=l.$implicit;e.Q6J("value",t.id),e.xp6(1),e.Oqu(t.nombre)}}let G=(()=>{class o{constructor(t,n,i,a,r){this.router=t,this.snackbar=n,this.route=i,this.establecimientoApi=a,this.authApi=r,this.listadoZonas=[],this.listadoCategorias=[],this.idEstablecimientoSugerido=0,this.nombre="",this.descripcion="",this.direccion="",this.telefono="",this.foto="",this.enlace="",this.numResenas=0,this.id_zona=0,this.id_categoria=0,this.tokenApi=""}ngOnInit(){var t=this;return(0,d.Z)(function*(){if(t.tokenApi=sessionStorage.getItem("tokenApi"),t.route.queryParams.subscribe(a=>{t.idEstablecimientoSugerido=a.sugerenciaId}),console.log("Id sugerencia: "+t.idEstablecimientoSugerido),null!=t.idEstablecimientoSugerido){const a=yield t.establecimientoApi.getSugerenciaApiById(t.idEstablecimientoSugerido,t.tokenApi).toPromise();t.nombre=a[0].nombre,t.enlace=a[0].enlace}const n=yield t.establecimientoApi.getZonasApi(t.tokenApi).toPromise();t.listadoZonas=n;const i=yield t.establecimientoApi.getCategoriasApi(t.tokenApi).toPromise();t.listadoCategorias=i})()}goToList(){this.router.navigate(["/establecimientos/list"])}obtenerNombreZona(t){let n="";for(const i of this.listadoZonas)i.id==t&&(n=i.nombre),0===t&&(n="Sin Especificar");return n}obtenerNombreCategoria(t){let n="";for(const i of this.listadoCategorias)i.id==t&&(n=i.nombre),0===t&&(n="Sin Especificar");return n}evitarErrorEnFoto(t){return 0===t.length?"assets/no_foto.png":t}addEstablecimientoApi(){var t=this;return(0,d.Z)(function*(){if(0===t.nombre.length||0===t.id_zona||0===t.id_categoria)return void t.snackbar.open("No has rellenado todos los datos obligatorios","Cerrar",{duration:2e3,panelClass:["background"]});const n={id:0,id_zona:parseInt(t.id_zona.toString()),id_categoria:parseInt(t.id_categoria.toString()),nombre:t.nombre,descripcion:t.descripcion,numResenas:t.numResenas,direccion:t.direccion,telefono:t.telefono,foto:t.foto,enlace:t.enlace};null!=t.idEstablecimientoSugerido?(yield t.establecimientoApi.addEstablecimientoApi(n,t.tokenApi).toPromise(),yield t.establecimientoApi.deleteSugerenciaApiAddPage(t.idEstablecimientoSugerido,t.tokenApi).toPromise(),t.snackbar.open("Establecimiento a\xf1adido correctamente","Cerrar",{duration:2e3,panelClass:["background"]}),t.router.navigate(["/establecimientos"])):(yield t.establecimientoApi.addEstablecimientoApi(n,t.tokenApi).toPromise(),t.snackbar.open("Establecimiento a\xf1adido correctamente","Cerrar",{duration:2e3,panelClass:["background"]}),t.router.navigate(["/establecimientos"]))})()}static#e=this.\u0275fac=function(n){return new(n||o)(e.Y36(p.F0),e.Y36(m.ux),e.Y36(p.gz),e.Y36(b.X),e.Y36(u.Q))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-add-page"]],decls:92,vars:21,consts:[[2,"height","70%","width","100%"],[2,"font-family","monospace","text-align","center","padding","20px"],[1,"container","py-4"],["id","pageHeaderTitle",1,"h1","text-center"],[1,"postcard","dark","blue",2,"width","70%","margin","auto"],["href","#",1,"postcard__img_link"],[1,"postcard__img",3,"src","alt"],[1,"postcard__text"],[1,"postcard__title","blue"],[2,"font-size","15px"],[1,"postcard__subtitle","small"],["datetime","2020-05-25 12:00:00"],[1,"fas","fa-calendar-alt","mr-2"],[1,"postcard__bar"],[2,"font-size","15px","font-weight","bold"],[2,"float","left"],["target","_blank","type","button",1,"btn","btn-outline-primary",2,"width","30%","margin-right","20px",3,"href"],[2,"height","20%","width","100%","margin-bottom","30px"],[2,"width","70%","margin","auto"],[1,"input-group","flex-nowrap",2,"width","100%","margin","auto","padding","10px"],["for","nombre",2,"text-align","left","margin-top","10px","margin-right","10px"],["type","text","placeholder","Nombre","aria-label","Nombre","aria-describedby","addon-wrapping","name","nombre","required","",1,"form-control",3,"ngModel","ngModelChange"],["for","zona",2,"text-align","left","margin-top","10px","margin-right","10px"],["id","zona","name","zona",1,"form-control",3,"ngModel","ngModelChange"],["value","0","disabled","","selected","","hidden",""],[3,"value",4,"ngFor","ngForOf"],["for","numResenas",2,"text-align","left","margin-top","10px","margin-right","10px"],["type","number","placeholder","N\xfamero de Rese\xf1as","aria-label","N\xfamero de Rese\xf1as","aria-describedby","addon-wrapping","name","numResenas",1,"form-control",3,"ngModel","ngModelChange"],["id","caterogia","name","zona",1,"form-control",3,"ngModel","ngModelChange"],["for","descripcion",2,"text-align","left","margin-top","10px","margin-right","10px"],["type","text","placeholder","Descripci\xf3n","aria-label","Descripci\xf3n","aria-describedby","addon-wrapping","name","descripcion",1,"form-control",3,"ngModel","ngModelChange"],["for","direccion",2,"text-align","left","margin-top","10px","margin-right","10px"],["type","text","placeholder","Direcci\xf3n","aria-label","Direcci\xf3n","aria-describedby","addon-wrapping","name","direccion",1,"form-control",3,"ngModel","ngModelChange"],["for","telefono",2,"text-align","left","margin-top","10px","margin-right","10px"],["type","text","placeholder","Tel\xe9fono","aria-label","Tel\xe9fono","aria-describedby","addon-wrapping","name","telefono",1,"form-control",3,"ngModel","ngModelChange"],["for","foto",2,"text-align","left","margin-top","10px","margin-right","10px"],["type","text","placeholder","Enlace para la foto","aria-label","Enlace para la foto","aria-describedby","addon-wrapping","name","foto",1,"form-control",3,"ngModel","ngModelChange"],["for","enlace",2,"text-align","left","margin-top","10px","margin-right","10px"],["type","text","placeholder","Enlace al sitio web","aria-label","Enlace al sitio web","aria-describedby","addon-wrapping","name","enlace",1,"form-control",3,"ngModel","ngModelChange"],[2,"font-family","monospace","width","50%","margin","auto","margin-top","20px","margin-bottom","10px"],["type","button",1,"btn","btn-outline-success",2,"margin-right","20px","float","left",3,"click"],["type","button",1,"btn","btn-outline-danger",2,"float","right",3,"click"],[3,"value"]],template:function(n,i){1&n&&(e.TgZ(0,"div",0)(1,"h1",1),e._uU(2,"Vista Previa"),e.qZA(),e.TgZ(3,"section")(4,"div",2),e._UZ(5,"h1",3),e.TgZ(6,"div",4)(7,"a",5),e._UZ(8,"img",6),e.qZA(),e.TgZ(9,"div",7)(10,"h1",8)(11,"a"),e._uU(12),e.TgZ(13,"span",9),e._uU(14),e.qZA()()(),e.TgZ(15,"div",10)(16,"time",11),e._UZ(17,"i",12),e._uU(18),e.qZA()(),e._UZ(19,"div",13),e.TgZ(20,"p"),e._uU(21),e.qZA(),e.TgZ(22,"p")(23,"span",14),e._uU(24,"Direcci\xf3n: "),e.qZA(),e._uU(25),e.qZA(),e.TgZ(26,"p")(27,"span",14),e._uU(28,"Tel\xe9fono: "),e.qZA(),e._uU(29),e.qZA(),e.TgZ(30,"div",15)(31,"a",16),e._uU(32,"Sitio web"),e.qZA()()()()()()(),e.TgZ(33,"div",17)(34,"h1",1),e._uU(35,"A\xf1adir establecimiento:"),e.qZA(),e.TgZ(36,"div",18)(37,"form",19)(38,"label",20),e._uU(39,"Nombre:"),e.qZA(),e.TgZ(40,"input",21),e.NdJ("ngModelChange",function(r){return i.nombre=r}),e.qZA()()(),e.TgZ(41,"div",18)(42,"form",19)(43,"label",22),e._uU(44,"Zona:"),e.qZA(),e.TgZ(45,"select",23),e.NdJ("ngModelChange",function(r){return i.id_zona=r}),e.TgZ(46,"option",24),e._uU(47,"Selecciona una zona*"),e.qZA(),e.YNc(48,B,2,2,"option",25),e.qZA()()(),e.TgZ(49,"div",18)(50,"form",19)(51,"label",26),e._uU(52,"N\xfamero de Rese\xf1as:"),e.qZA(),e.TgZ(53,"input",27),e.NdJ("ngModelChange",function(r){return i.numResenas=r}),e.qZA()()(),e.TgZ(54,"div",18)(55,"form",19)(56,"label",22),e._uU(57,"Categor\xeda:"),e.qZA(),e.TgZ(58,"select",28),e.NdJ("ngModelChange",function(r){return i.id_categoria=r}),e.TgZ(59,"option",24),e._uU(60,"Selecciona una zona*"),e.qZA(),e.YNc(61,j,2,2,"option",25),e.qZA()()(),e.TgZ(62,"div",18)(63,"form",19)(64,"label",29),e._uU(65,"Descripci\xf3n:"),e.qZA(),e.TgZ(66,"input",30),e.NdJ("ngModelChange",function(r){return i.descripcion=r}),e.qZA()()(),e.TgZ(67,"div",18)(68,"form",19)(69,"label",31),e._uU(70,"Direcci\xf3n:"),e.qZA(),e.TgZ(71,"input",32),e.NdJ("ngModelChange",function(r){return i.direccion=r}),e.qZA()()(),e.TgZ(72,"div",18)(73,"form",19)(74,"label",33),e._uU(75,"Tel\xe9fono:"),e.qZA(),e.TgZ(76,"input",34),e.NdJ("ngModelChange",function(r){return i.telefono=r}),e.qZA()()(),e.TgZ(77,"div",18)(78,"form",19)(79,"label",35),e._uU(80,"Enlace foto:"),e.qZA(),e.TgZ(81,"input",36),e.NdJ("ngModelChange",function(r){return i.foto=r}),e.qZA()()(),e.TgZ(82,"div",18)(83,"form",19)(84,"label",37),e._uU(85,"Enlace web:"),e.qZA(),e.TgZ(86,"input",38),e.NdJ("ngModelChange",function(r){return i.enlace=r}),e.qZA()()(),e.TgZ(87,"div",39)(88,"button",40),e.NdJ("click",function(){return i.addEstablecimientoApi()}),e._uU(89,"Aceptar"),e.qZA(),e.TgZ(90,"button",41),e.NdJ("click",function(){return i.goToList()}),e._uU(91,"Cancelar"),e.qZA()()()),2&n&&(e.xp6(8),e.s9C("src",i.evitarErrorEnFoto(i.foto),e.LSH),e.s9C("alt",i.foto),e.xp6(4),e.AsE("",i.nombre," (",i.obtenerNombreZona(i.id_zona),") "),e.xp6(2),e.hij("Rese\xf1as: ",i.numResenas,""),e.xp6(4),e.hij("Categor\xeda: ",i.obtenerNombreCategoria(i.id_categoria)," "),e.xp6(3),e.Oqu(i.descripcion),e.xp6(4),e.Oqu(i.direccion),e.xp6(4),e.Oqu(i.telefono),e.xp6(2),e.s9C("href",i.enlace,e.LSH),e.xp6(9),e.Q6J("ngModel",i.nombre),e.xp6(5),e.Q6J("ngModel",i.id_zona),e.xp6(3),e.Q6J("ngForOf",i.listadoZonas),e.xp6(5),e.Q6J("ngModel",i.numResenas),e.xp6(5),e.Q6J("ngModel",i.id_categoria),e.xp6(3),e.Q6J("ngForOf",i.listadoCategorias),e.xp6(5),e.Q6J("ngModel",i.descripcion),e.xp6(5),e.Q6J("ngModel",i.direccion),e.xp6(5),e.Q6J("ngModel",i.telefono),e.xp6(5),e.Q6J("ngModel",i.foto),e.xp6(5),e.Q6J("ngModel",i.enlace))},dependencies:[g.sg,s._Y,s.YN,s.Kr,s.Fj,s.wV,s.EJ,s.JJ,s.JL,s.Q7,s.On,s.F]})}return o})(),X=(()=>{class o{constructor(t,n,i,a,r){this.activatedRoute=t,this.router=n,this.snackbar=i,this.establecimientoApi=a,this.authApi=r,this.idEstablecimiento=0,this.nombreEstablecimiento="",this.tokenApi=""}goToList(){this.router.navigate(["/establecimientos/list"])}ngOnInit(){this.tokenApi=sessionStorage.getItem("tokenApi"),this.activatedRoute.params.pipe((0,Z.w)(({id:t})=>this.establecimientoApi.getEstablecimientoApiById(t,this.tokenApi))).subscribe(t=>{if(!t)return this.router.navigate(["/establecimientos/list"]);this.establecimientoDetalles=t[0],this.idEstablecimiento=t[0].id,this.nombreEstablecimiento=t[0].nombre})}deleteEstablecimientoApi(t){this.establecimientoApi.deleteEstablecimientoApi(t,this.tokenApi).subscribe(n=>{this.snackbar.open("Establecimiento eliminado correctamente","Cerrar",{duration:2e3,panelClass:["background"]}),this.router.navigate(["/establecimientos/list"])},n=>{this.snackbar.open("Error al eliminar el establecimiento","Cerrar",{duration:2e3,panelClass:["background"]}),this.router.navigate(["/establecimientos/list"])})}static#e=this.\u0275fac=function(n){return new(n||o)(e.Y36(p.gz),e.Y36(p.F0),e.Y36(m.ux),e.Y36(b.X),e.Y36(u.Q))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-delete-page"]],decls:8,vars:1,consts:[[2,"width","50%","height","40%","margin","auto","background-color","white","margin-top","70px","border-radius","30px"],[2,"font-family","monospace","text-align","center"],[2,"width","50%","margin","auto","font-family","monospace"],["type","button",1,"btn","btn-outline-success",2,"margin-top","10px",3,"click"],["type","button",1,"btn","btn-outline-danger",3,"click"]],template:function(n,i){1&n&&(e.TgZ(0,"div",0)(1,"h1",1),e._uU(2),e.qZA(),e.TgZ(3,"div",2)(4,"button",3),e.NdJ("click",function(){return i.deleteEstablecimientoApi(i.idEstablecimiento)}),e._uU(5,"Aceptar"),e.qZA(),e.TgZ(6,"button",4),e.NdJ("click",function(){return i.goToList()}),e._uU(7,"Cancelar"),e.qZA()()()),2&n&&(e.xp6(2),e.hij("\xbfSeguro que deseas eliminar el establecimiento: ",i.nombreEstablecimiento,"."))}})}return o})();function K(o,l){1&o&&(e.TgZ(0,"div",4)(1,"h1",5),e._uU(2,"Mis Lugares Favoritos"),e.qZA()())}function V(o,l){1&o&&(e.TgZ(0,"div",4)(1,"h1",5),e._uU(2,"No tienes Lugares Favoritos"),e.qZA()())}function W(o,l){if(1&o){const t=e.EpF();e.TgZ(0,"section")(1,"div",6),e._UZ(2,"h1",7),e.TgZ(3,"article",8)(4,"a",9),e._UZ(5,"img",10),e.qZA(),e.TgZ(6,"div",11)(7,"h1",12)(8,"a"),e._uU(9),e.TgZ(10,"span",13),e._uU(11),e.qZA()()(),e.TgZ(12,"div",14)(13,"time",15),e._UZ(14,"i",16),e._uU(15),e.qZA()(),e._UZ(16,"div",17),e.TgZ(17,"p"),e._uU(18),e.qZA(),e.TgZ(19,"p")(20,"span",18),e._uU(21,"Direcci\xf3n: "),e.qZA(),e._uU(22),e.qZA(),e.TgZ(23,"p")(24,"span",18),e._uU(25,"Tel\xe9fono: "),e.qZA(),e._uU(26),e.qZA(),e.TgZ(27,"div",19)(28,"a",20),e._uU(29,"Sitio web"),e.qZA()(),e.TgZ(30,"div",21),e.NdJ("click",function(){const a=e.CHM(t).$implicit,r=e.oxw();return e.KtG(r.eliminaFavoritoApi(a.id))}),e._UZ(31,"input",22),e.O4$(),e.TgZ(32,"svg",23),e._UZ(33,"path",24),e.qZA()()()()()()}if(2&o){const t=l.$implicit,n=e.oxw();e.xp6(5),e.s9C("src",n.evitarErrorEnFoto(t.foto),e.LSH),e.s9C("alt",t.nombre),e.xp6(4),e.AsE("",null==t?null:t.nombre," (",n.obtenerNombreZona(t.id_zona),") "),e.xp6(2),e.hij("Rese\xf1as: ",null==t?null:t.numResenas,""),e.xp6(4),e.hij("Categor\xeda: ",n.obtenerNombreCategoria(t.id_categoria)," "),e.xp6(3),e.Oqu(null==t?null:t.descripcion),e.xp6(4),e.Oqu(t.direccion),e.xp6(4),e.Oqu(t.telefono),e.xp6(2),e.s9C("href",null==t?null:t.enlace,e.LSH)}}let ee=(()=>{class o{constructor(t,n,i,a){this.snackbar=t,this.router=n,this.establecimientoApi=i,this.authApi=a,this.id="",this.tokenApi="",this.listadoFavoritos=[],this.listadoFavoritosDetalles=[],this.listadoZonas=[],this.listadoCategorias=[]}ngOnInit(){var t=this;return(0,d.Z)(function*(){t.id=sessionStorage.getItem("id"),t.tokenApi=sessionStorage.getItem("tokenApi"),console.log(t.tokenApi);const n=yield t.establecimientoApi.getZonasApi(t.tokenApi).toPromise();t.listadoZonas=n;const i=yield t.establecimientoApi.getCategoriasApi(t.tokenApi).toPromise();t.listadoCategorias=i,t.obtenerDatosEstablecimientosFavoritosApi()})()}goToList(){this.router.navigate(["/establecimientos/list"])}obtenerNombreZona(t){let n="";for(const i of this.listadoZonas)i.id===t&&(n=i.nombre),0===t&&(n="Sin Especificar");return n}obtenerNombreCategoria(t){let n="";for(const i of this.listadoCategorias)i.id==t&&(n=i.nombre),0===t&&(n="Sin Especificar");return n}evitarErrorEnFoto(t){return 0===t.length?"assets/no_foto.png":t}obtenerDatosEstablecimientosFavoritosApi(){var t=this;return(0,d.Z)(function*(){const n=yield t.establecimientoApi.getFavoritosByUserApi(parseInt(t.id),t.tokenApi).toPromise();t.listadoFavoritos=n;for(let i=0;i<t.listadoFavoritos.length;i++)try{const a=yield t.establecimientoApi.getEstablecimientoApiById(t.listadoFavoritos[i].id_establecimiento,t.tokenApi).toPromise();void 0!==a&&a.length>0?t.listadoFavoritosDetalles.push(a[0]):console.error("La respuesta de getEstablecimientoApiById es undefined o vac\xeda.")}catch(a){console.error("Error al obtener establecimiento:",a)}})()}eliminaFavoritoApi(t){console.log(this.listadoFavoritos);const n=this.listadoFavoritos.find(i=>i.id_usuario===parseInt(this.id)&&i.id_establecimiento===t);console.log(n),console.log(n?.id),n?this.establecimientoApi.deleteFavoritoApi(n.id,this.tokenApi).subscribe(i=>{const a=this.listadoFavoritosDetalles.findIndex(r=>r.id===t);-1!==a&&this.listadoFavoritosDetalles.splice(a,1),this.snackbar.open("Establecimiento eliminado de favoritos","Cerrar",{duration:2e3,panelClass:["background"]}),0===this.listadoFavoritosDetalles.length&&this.router.navigate(["/establecimientos"])},i=>{this.snackbar.open("Error al eliminar el establecimiento","Cerrar",{duration:2e3,panelClass:["background"]})}):this.snackbar.open("No se encontr\xf3 el favorito para eliminar","Cerrar",{duration:2e3,panelClass:["background"]})}static#e=this.\u0275fac=function(n){return new(n||o)(e.Y36(m.ux),e.Y36(p.F0),e.Y36(b.X),e.Y36(u.Q))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-favourite-page"]],decls:6,vars:3,consts:[["style","padding: 40px;",4,"ngIf"],[4,"ngFor","ngForOf"],[2,"width","200px","height","45px","margin","auto","margin-top","30px","border-radius","10px"],["mat-raised-button","",2,"width","100%","font-family","monospace",3,"click"],[2,"padding","40px"],[2,"text-align","center","font-size","40px","font-family","monospace"],[1,"container","py-4"],["id","pageHeaderTitle",1,"h1","text-center"],[1,"postcard","dark","blue",2,"width","70%","margin","auto"],["href","#",1,"postcard__img_link"],[1,"postcard__img",3,"src","alt"],[1,"postcard__text"],[1,"postcard__title","blue"],[2,"font-size","15px"],[1,"postcard__subtitle","small"],["datetime","2020-05-25 12:00:00"],[1,"fas","fa-calendar-alt","mr-2"],[1,"postcard__bar"],[2,"font-size","15px","font-weight","bold"],[2,"float","left"],["target","_blank","type","button",1,"btn","btn-outline-primary",2,"width","30%","margin-right","20px",3,"href"],[1,"containerok",3,"click"],["type","checkbox"],["id","Layer_1","version","1.0","viewBox","0 0 24 24",0,"xml","space","preserve","xmlns","http://www.w3.org/2000/svg",0,"xmlns","xlink","http://www.w3.org/1999/xlink"],["d","M16.4,4C14.6,4,13,4.9,12,6.3C11,4.9,9.4,4,7.6,4C4.5,4,2,6.5,2,9.6C2,14,12,22,12,22s10-8,10-12.4C22,6.5,19.5,4,16.4,4z"]],template:function(n,i){1&n&&(e.YNc(0,K,3,0,"div",0),e.YNc(1,V,3,0,"div",0),e.YNc(2,W,34,10,"section",1),e.TgZ(3,"div",2)(4,"button",3),e.NdJ("click",function(){return i.goToList()}),e._uU(5,"Volver al listado"),e.qZA()()),2&n&&(e.Q6J("ngIf",i.listadoFavoritos.length>0),e.xp6(1),e.Q6J("ngIf",0===i.listadoFavoritos.length),e.xp6(1),e.Q6J("ngForOf",i.listadoFavoritosDetalles))},dependencies:[g.sg,g.O5,h.lW]})}return o})(),te=(()=>{class o{ngOnInit(){this.id=sessionStorage.getItem("id"),this.tokenApi=sessionStorage.getItem("tokenApi")}constructor(t,n,i,a){this.router=t,this.snackbar=n,this.establecimientoApi=i,this.authApi=a,this.numSugerencias=0,this.id="",this.tokenApi="",this.searchForm=new s.cw({nombre:new s.NI(""),enlace:new s.NI("")})}cancelar(){this.router.navigate(["/establecimientos"])}addSugerenciaApi(){const t=this.searchForm.get("nombre").value,n=this.searchForm.get("enlace").value;if(""===t||""===n)return void this.snackbar.open("No has rellenado todos los campos obligatorios","Cerrar",{duration:500,panelClass:["background"]}).afterDismissed().subscribe(()=>{});const i={id:0,id_usuario:parseInt(this.id,10),nombre:t,enlace:n};this.establecimientoApi.addSugerenciaApi(i,this.tokenApi).subscribe(a=>{this.snackbar.open("Sugerencia enviada correctamente","Cerrar",{duration:2e3,panelClass:["background"]}).afterDismissed().subscribe(()=>{}),this.router.navigate(["/establecimientos"])})}static#e=this.\u0275fac=function(n){return new(n||o)(e.Y36(p.F0),e.Y36(m.ux),e.Y36(b.X),e.Y36(u.Q))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-suggestion-page"]],decls:12,vars:2,consts:[[2,"padding","30px","text-align","center"],[2,"font-size","40px","font-family","monospace"],[1,"input-group","flex-nowrap",2,"width","40%","margin","auto","padding","20px",3,"formGroup"],["type","text","placeholder","Escribe el nombre del establecimiento*","aria-label","Username","aria-describedby","addon-wrapping","formControlName","nombre",1,"form-control"],["type","text","placeholder","Escribe el enlace al sitio web del establecimiento*","aria-label","Username","aria-describedby","addon-wrapping","formControlName","enlace",1,"form-control"],[2,"font-family","monospace","width","20%","margin","auto","margin-top","30px"],["type","button",1,"btn","btn-outline-success",2,"margin-right","10px","float","left",3,"click"],["type","button",1,"btn","btn-outline-danger",2,"float","right",3,"click"]],template:function(n,i){1&n&&(e.TgZ(0,"div",0)(1,"h1",1),e._uU(2,"Sugerencia de un Establecimiento"),e.qZA()(),e.TgZ(3,"form",2),e._UZ(4,"input",3),e.qZA(),e.TgZ(5,"form",2),e._UZ(6,"input",4),e.qZA(),e.TgZ(7,"div",5)(8,"button",6),e.NdJ("click",function(){return i.addSugerenciaApi()}),e._uU(9,"Aceptar"),e.qZA(),e.TgZ(10,"button",7),e.NdJ("click",function(){return i.cancelar()}),e._uU(11,"Cancelar"),e.qZA()()),2&n&&(e.xp6(3),e.Q6J("formGroup",i.searchForm),e.xp6(2),e.Q6J("formGroup",i.searchForm))},dependencies:[s._Y,s.Fj,s.JJ,s.JL,s.sg,s.u]})}return o})();var A=c(1391);const ie=[{path:"",component:q,children:[{path:"list",component:J},{path:"search",component:O},{path:"add",component:G,canActivate:[A.uy]},{path:"favourite-list",component:ee},{path:"suggestions",component:te},{path:"details/:id",component:Q},{path:"delete/:id",component:X,canActivate:[A.uy]},{path:"edit/:id",component:$,canActivate:[A.uy]},{path:"**",redirectTo:"list"}]}];let ne=(()=>{class o{static#e=this.\u0275fac=function(n){return new(n||o)};static#t=this.\u0275mod=e.oAB({type:o});static#i=this.\u0275inj=e.cJS({imports:[p.Bz.forChild(ie),p.Bz]})}return o})();var oe=c(1423);let ae=(()=>{class o{static#e=this.\u0275fac=function(n){return new(n||o)};static#t=this.\u0275mod=e.oAB({type:o});static#i=this.\u0275inj=e.cJS({imports:[g.ez,ne,oe.q,s.UX,s.u5]})}return o})()}}]);